
$(document).ready(function(){
var ww = ($(window).width()-$("#logo").width())/2;
console.log($(window).width());console.log($("#logo").width());
if ($("#logo").width()==0) { ww="-15%"};
//$("#intro img").css('margin-left',ww);$("#intro").fadeIn();


setTimeout(function(){},0);


	setTimeout(function(){
		$("#logo").addClass("zoomed"),
		setTimeout(function(){$("#intro").css("opacity","0"),
			$("#container").css("opacity","1"),
			setTimeout(function(){$("#intro").hide()},1e3)},2000)}
		,100)

$('.expandable').each(function(){


		var pw = $(window).width()>570 ? $(this).width()  : $(this).width()  ;
		var ph = $(window).width()>570 ? $(this).height() + 8 : $(this).height();
		$(this).attr('data-w',pw).attr('data-h',ph);

});

$('.expandable').click(function(){


	if ($(this).height() < 60) {
		$(this).children('.titlea').hide();
		$(this).children('.plus').css('opacity','0');
		var w = $(this).children('.content').width() + 40;
		var h = $(this).children('.content').height() + 80;
		$(this).addClass('open');

		//if ($(window).width()<540){$(this).css({'background-color':'rgba(255,255,255,1)'});
		
		//$('#content').animate({'margin-top': '232px'});}


		$(this).animate({
			width: [w,"swing"],
			height: [h, "swing"]
		},600, function(){
				
				$(this).children('.content,.titleb').fadeIn(200);
			$(this).children('.plus').attr('src','./img/cross.png').animate({opacity:1},200);
			
			$(this).children('.content').css('position','relative');

	})
				

	} else {

		$(this).children('.titleb').fadeOut();
		$(this).children('.content').fadeOut();
		$(this).children('.plus').animate({opacity: 0},200,function(){$(this).attr('src','./img/plus.png')});
		var h = $(this).attr('data-h');
		var w = $(window).width()>361 ? $(this).attr('data-w') : '100%';
		$(this).animate({
			width:[w,"swing"],
			height: [h, "swing"]	
		},600, function(){
				$(this).children('.content').css('position','absolute'); 
				$(this).removeClass('open'); 
				$(this).children('.titlea').fadeIn(200);
				$(this).children('.plus').animate({opacity: 1},200);
				if ($(window).width()<540){$(this).css({'background-color':'rgba(255,255,255,0.75)'});
				//$('#content').animate({'margin-top': '168px'});
			}
						});
				}
		
		
	});

headerHeight();

$(window).on("resize", function() {
	var ww = ($(window).width()-$("#logo").width())/2;
$("#intro").css('margin-left',ww);

if ($(window).width() < 877){$('.header').attr('style','');}
else {
var pw = $(window).width()>570 ? $(this).width() +14 : $(this).width() ;
		var ph = $(window).width()>570 ? $(this).height() + 8 : $(this).height();
		$(this).attr('data-w',pw).attr('data-h',ph);

}

});





$(window).on("scroll", function () { 
    
headerHeight(); 

	var building = $('#buildingend').offset().top + $('#buildingend').height();
	var location = $('#location').offset().top + $('#location').height();
	var contact =	$('#contact').offset().top + $('#contact').height();
	var download = $('#download').offset().top + $('#download').height();

	//console.log(building,location,contact,download,$(window).scrollTop(),$(window).scrollTop() + $(window).height());

	if ($(window).scrollTop() < building) { $('.menu a').removeClass('active'); $('.athebuilding').addClass('active'); }
	if (building < $(window).scrollTop() && $(window).scrollTop() < location) { $('.menu a').removeClass('active'); $('.alocation').addClass('active'); }		
	if (location < $(window).scrollTop() && $(window).scrollTop() < contact) { $('.menu a').removeClass('active'); $('.acontact').addClass('active'); }	
	if (($(window).scrollTop() + $(window).height()) > download) { $('.menu a').removeClass('active'); $('.adownload').addClass('active');}	


},250);

$('.menu a').click(function(e) {
    e.preventDefault();  //stop the browser from following
    var href = $(this).attr('href');
    $('html,body').animate({ scrollTop: $(href).offset().top }, 1000);
});



function headerHeight(){
				if ($(window).width() > 877){
				
				    	

				       if ($(window).scrollTop() > 10) { if ( $('.header').height() > 61){
				       	$('.menu').animate({top:22},200);
				       	$('.header').animate({height: 60},200, function(){});
				       	
				       	$('.menuimg').fadeOut(200,function(){$(this).attr('src','./img/5-monogram.png').animate({top:11}).fadeIn(200)});
				       }}
				      else {
				      	if ($('.header').height() < 61) {
				      	$('.header').animate({height: 110},200);
				      	$('.menu').animate({top:62},200);
				      	$('.menuimg').fadeOut(200,function(){$(this).attr('src','./img/5-the-square-stokley-park.png').animate({top:41}).fadeIn(200);});
				      }
				      }
				}

				
			};



$('.submit').click(function(e) {
    e.preventDefault();  //stop the browser from following
    window.location.href = 'Breakfast presentation-26 October.pdf';
});


});

;(function ($) {
    var on = $.fn.on, timer;
    $.fn.on = function () {
        var args = Array.apply(null, arguments);
        var last = args[args.length - 1];

        if (isNaN(last) || (last === 1 && args.pop())) return on.apply(this, args);

        var delay = args.pop();
        var fn = args.pop();

        args.push(function () {
            var self = this, params = arguments;
            clearTimeout(timer);
            timer = setTimeout(function () {
                fn.apply(self, params);
            }, delay);
        });

        return on.apply(this, args);
    };
}(this.jQuery || this.Zepto));
